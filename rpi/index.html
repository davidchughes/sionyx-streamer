<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>SiOnyx Aurora</title>

<style>
* {
  margin:0;
  padding:0;
  box-sizing:border-box;
}

html, body {
  width:100%;
  height:100%;
  overflow:hidden;
  background:#000;
  font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  color:#fff;
}

/* ---- MJPEG BACKGROUND STREAM (NO SQUISH) ---- */
#video-bg {
  position:fixed;
  inset:0;
  z-index:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

#mjpeg {
  width:100%;
  height:100%;
  object-fit: contain;
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  pointer-events: none;
}

/* ---- PANELS 30% ALPHA + BLUR ---- */
.panel {
  background: rgba(0,0,0,0.30);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

/* ---- WRAPPER LAYOUT ---- */
#wrapper {
  position:fixed;
  inset:0;
  z-index:100;
}

/* ---- WIDE MODE : 3 COLUMNS ---- */
.wide {
  display:grid;
  grid-template-columns: 40px 1fr 40px;
  height:100%;
}

/* ---- TALL MODE : 3 ROWS ---- */
.tall {
  display:grid;
  grid-template-rows: 60px 1fr 60px;
  height:100%;
}

/* ---- STATUS AREA ---- */
#status-bar {
  display:flex;
  flex-direction:column;
  gap:12px;
  padding:10px;
  height:100%;
}

.tall #status-bar {
  flex-direction:row;
  align-items:center;
  height:60px;
}

/* ---- CONTROLS AREA ---- */
#ctrl-col {
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:space-between;
}

.tall #ctrl-col {
  flex-direction:row;
  align-items:center;
  justify-content:flex-start;
}

/* ---- BUTTON APPEARANCE UNIFIED ---- */
.btn {
  width:35px;
  height:35px;
  border:2px solid #444;
  background:#0a0a0a;
  color:#fff;

  display:flex;
  align-items:center;
  justify-content:center;

  cursor:pointer;
  user-select:none;
  font-weight:800;

  border-radius:12px;
}

.btn.active { border-color:#0a84ff; }

.recording { animation:pulse 1.3s infinite; }

@keyframes pulse {
  0%,100% {opacity:1;}
  50%     {opacity:.6;}
}

/* ---- TOP BUTTON GROUP ---- */
#top-btns {
  display:flex;
  gap:5px;
}

.wide #top-btns {
  flex-direction:column;
}

.tall #top-btns {
  flex-direction:row;
}

/* ---- ZOOM SLIDER CENTERED ---- */
#zoom-control {
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:8px;
}

.wide #zoom {
  width:200px;
  transform: rotate(-90deg) translate(-125px);
  transform-origin:left;
  margin:auto;
}

.tall #zoom {
  width:40%;
  height:80%;
}

.tall #zoom-disp {
  order:1;
}

#zoom-disp {
  font-size:12px;
  font-weight:900;
  height:32px;
}

/* ---- AVERAGING WINDOW  [-] N [+]  CONTROL ---- */
#history-ctrl {
  display: flex;
  align-items: center;
  gap: 4px;
  padding-bottom: 4px;
}

/* wide: label on top, stepper below */
.wide #history-ctrl {
  flex-direction: column;
}

/* tall: label left, stepper right */
.tall #history-ctrl {
  flex-direction: row;
  margin: 0 4px;
}

/*#history-ctrl .h-label {
  font-size: 9px;
  font-weight: 700;
  color: #888;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  white-space: nowrap;
}

.wide #history-ctrl .h-label {
  text-align: center;
}
*/
/* wide: stepper is horizontal  [-] N [+] */
#history-stepper {
  flex-direction: column-reverse;
}

/* tall/landscape: stepper is vertical â€” [+] on top, N middle, [-] bottom
   column-reverse flips DOM order [âˆ’, val, +] â†’ [+, val, âˆ’]           */
.tall #history-stepper {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 3px;
}

/* [-] and [+] buttons */
.h-step {
  width: 24px;
  height: 24px;
  border: 2px solid #444;
  background: #0a0a0a;
  color: #ccc;
  font-size: 16px;
  font-weight: 900;
  line-height: 1;
  border-radius: 7px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
}

.h-step:active {
  background: #1c1c1e;
  border-color: #666;
}

.h-step.disabled {
  opacity: 0.22;
  cursor: default;
  pointer-events: none;
}

/* value readout */
#history-val {
  min-width: 26px;
  height: 24px;
  border: 2px solid #30d158;
  border-radius: 7px;
  background: #0a0a0a;
  color: #30d158;
  font-size: 11px;
  font-weight: 900;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 3px;
}

/* ---- COLOR SELECTOR SIZE SAME AS BUTTONS ---- */
#color-btns {
  display:flex;
  gap:10px;
}

.wide #color-btns {
  flex-direction:column;
  margin-top: auto;
}

.tall #color-btns {
  flex-direction:row;
  margin-left:auto;
}

.btn,
.color-item,
.color-btns {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  touch-action: manipulation;
}

.color-item {
  width:35px;
  height:35px;
  border:2px solid #444;
  border-radius:12px;

  display:flex;
  align-items:center;
  justify-content:center;

  cursor:pointer;
}

.color-item.active {
  border-color:#0a84ff;
}

/* stripes */
.rgb    { background:linear-gradient(to bottom, red,green,blue); }
.mono   { background:linear-gradient(to right, black,gray,white); }
.green  { background:linear-gradient(to bottom, green,#003300,black); }

/* ---- DARK MODE TOGGLE ---- */
#btn-darkmode.active {
  border-color: #ffd60a;
}

/* ---- RECONNECT BUTTON ---- */
#btn-reconnect.disabled {
  opacity: 0.35;
  cursor: default;
  pointer-events: none;
}
#btn-reconnect.arming {
  border-color: #ff9f0a;
}

/* Style the track */
input[type="range"]::-webkit-slider-runnable-track {
  background: #111111;
  height: 10px;
  border-radius: 5px;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  background: #4CAF50;
  height: 20px;
  width: 20px;
  border-radius: 50%;
  cursor: pointer;
  margin-top: -5px;
}

input[type="range"]::-moz-range-track {
  background: #111111;
  height: 10px;
  border-radius: 5px;
  cursor: pointer;
}

input[type="range"]::-moz-range-thumb {
  background: #4CAF50;
  height: 20px;
  width: 20px;
  border-radius: 50%;
  cursor: pointer;
}
</style>
</head>

<body>

<!-- BACKGROUND VIDEO -->
<div id="video-bg">
  <img id="mjpeg">
</div>

<div id="wrapper" class="wide">

  <!-- STATUS LEFT COLUMN / TOP ROW -->
  <div id="status-bar" class="panel">

     <div style="margin:auto">
        <div class="btn" id="btn-full">â›¶</div>
     </div>

     <!-- ZOOM WITH NUMBER ABOVE -->
     <div id="zoom-control">
        <input type="range" id="zoom" min="100" max="300" step="20" value="100">
        <div id="zoom-disp">1.0x</div>
     </div>

     <!-- AVERAGING WINDOW  [-] N [+] -->
     <div id="history-ctrl">
       <div id="history-stepper">
         <div class="h-step" id="btn-history-dec">âˆ’</div>
         <div id="history-val">8</div>
         <div class="h-step" id="btn-history-inc">+</div>
       </div>
     </div>

     <div class="btn" id="btn-streammode" title="Toggle raw / enhanced stream"> Fx </div>
     <!-- Reconnect stream -->
     <div class="btn" id="btn-reconnect" title="Reconnect stream">âŸ³</div>

  </div>

  <div></div>

  <!-- CONTROLS RIGHT COLUMN / BOTTOM ROW -->
  <div id="ctrl-col" class="panel">

     <!-- recording / photo / eis TOGGLES -->
     <div id="color-btns">
        <div class="btn" id="btn-record">ðŸ”´</div>
        <div class="btn" id="btn-photo">ðŸ“·</div>
        <div class="btn" id="btn-eis">E</div>
     </div>

     <!-- COLOR SELECTOR + DARK MODE -->
     <div id="color-btns">
      <div class="color-item rgb"   data-mode="NightColor"></div>
      <div class="color-item mono"  data-mode="GrayScale"></div>
      <div class="color-item green" data-mode="Green"></div>

      <!-- Light / Dark mode toggle -->
      <div class="btn" id="btn-darkmode" title="Toggle enhancement mode">ðŸŒ™</div>
    </div>

  </div>

</div>
<script src="NoSleep.min.js"></script>
<script src="viewer.js"></script>

<script>
function applyLayout(){
 const wrap=document.getElementById("wrapper");
 const ar=window.innerWidth/window.innerHeight;

 if(ar>=16/9){
   wrap.className="wide";
 }else{
   wrap.className="tall";
 }
}
window.addEventListener("resize",applyLayout);
window.addEventListener("orientationchange",applyLayout);

applyLayout();
</script>

</body>
</html>